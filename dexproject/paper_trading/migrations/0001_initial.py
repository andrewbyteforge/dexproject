# Generated by Django 5.2.6 on 2025-11-22 19:01

import django.core.validators
import django.db.models.deletion
import uuid
from decimal import Decimal
from django.conf import settings
from django.db import migrations, models


class Migration(migrations.Migration):

    initial = True

    dependencies = [
        migrations.swappable_dependency(settings.AUTH_USER_MODEL),
    ]

    operations = [
        migrations.CreateModel(
            name="PaperTradingAccount",
            fields=[
                (
                    "account_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique account identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                ("name", models.CharField(help_text="Account name", max_length=100)),
                (
                    "description",
                    models.TextField(blank=True, help_text="Account description"),
                ),
                (
                    "initial_balance_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10000.00"),
                        help_text="Starting virtual balance in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "current_balance_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10000.00"),
                        help_text="Current virtual balance in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        default=True, help_text="Whether account is active"
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Account creation timestamp"
                    ),
                ),
                (
                    "last_activity",
                    models.DateTimeField(
                        auto_now=True, help_text="Last activity timestamp"
                    ),
                ),
                (
                    "total_trades",
                    models.IntegerField(default=0, help_text="Total number of trades"),
                ),
                (
                    "winning_trades",
                    models.IntegerField(
                        default=0, help_text="Number of winning trades"
                    ),
                ),
                (
                    "losing_trades",
                    models.IntegerField(default=0, help_text="Number of losing trades"),
                ),
                (
                    "total_profit_loss_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Total profit/loss in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "user",
                    models.ForeignKey(
                        help_text="Account owner",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="paper_accounts",
                        to=settings.AUTH_USER_MODEL,
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Trading Account",
                "verbose_name_plural": "Paper Trading Accounts",
                "db_table": "paper_trading_accounts",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperTrade",
            fields=[
                (
                    "trade_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique trade identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "trade_type",
                    models.CharField(
                        choices=[("buy", "Buy"), ("sell", "Sell"), ("swap", "Swap")],
                        help_text="Type of trade",
                        max_length=10,
                    ),
                ),
                (
                    "token_in_address",
                    models.CharField(help_text="Input token address", max_length=42),
                ),
                (
                    "token_in_symbol",
                    models.CharField(help_text="Input token symbol", max_length=20),
                ),
                (
                    "token_out_address",
                    models.CharField(help_text="Output token address", max_length=42),
                ),
                (
                    "token_out_symbol",
                    models.CharField(help_text="Output token symbol", max_length=20),
                ),
                (
                    "amount_in",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Amount in (wei)",
                        max_digits=36,
                    ),
                ),
                (
                    "amount_in_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10.00"),
                        help_text="Amount in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "expected_amount_out",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Expected output amount",
                        max_digits=36,
                    ),
                ),
                (
                    "actual_amount_out",
                    models.DecimalField(
                        blank=True,
                        decimal_places=18,
                        default=None,
                        help_text="Actual output amount",
                        max_digits=36,
                        null=True,
                    ),
                ),
                (
                    "simulated_gas_price_gwei",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1.0"),
                        help_text="Simulated gas price",
                        max_digits=10,
                    ),
                ),
                (
                    "simulated_gas_used",
                    models.IntegerField(
                        default=21000, help_text="Simulated gas units used"
                    ),
                ),
                (
                    "simulated_gas_cost_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.50"),
                        help_text="Simulated gas cost in USD",
                        max_digits=10,
                    ),
                ),
                (
                    "simulated_slippage_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.50"),
                        help_text="Simulated slippage percentage",
                        max_digits=5,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Trade creation timestamp"
                    ),
                ),
                (
                    "executed_at",
                    models.DateTimeField(
                        blank=True, help_text="Trade execution timestamp", null=True
                    ),
                ),
                (
                    "execution_time_ms",
                    models.IntegerField(
                        blank=True,
                        help_text="Simulated execution time in milliseconds",
                        null=True,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("pending", "Pending"),
                            ("executing", "Executing"),
                            ("completed", "Completed"),
                            ("failed", "Failed"),
                            ("cancelled", "Cancelled"),
                        ],
                        default="pending",
                        help_text="Current trade status",
                        max_length=20,
                    ),
                ),
                (
                    "error_message",
                    models.TextField(blank=True, help_text="Error message if failed"),
                ),
                (
                    "mock_tx_hash",
                    models.CharField(
                        blank=True,
                        help_text="Simulated transaction hash",
                        max_length=66,
                    ),
                ),
                (
                    "mock_block_number",
                    models.IntegerField(
                        blank=True, help_text="Simulated block number", null=True
                    ),
                ),
                (
                    "strategy_name",
                    models.CharField(
                        blank=True,
                        help_text="Strategy that generated this trade",
                        max_length=100,
                    ),
                ),
                (
                    "metadata",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="AI trade context (intel level, confidence, reasoning)",
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Associated account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="trades",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Trade",
                "verbose_name_plural": "Paper Trades",
                "db_table": "paper_trades",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperStrategyConfiguration",
            fields=[
                (
                    "config_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique configuration identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "name",
                    models.CharField(help_text="Configuration name", max_length=100),
                ),
                (
                    "is_active",
                    models.BooleanField(
                        default=True, help_text="Whether this configuration is active"
                    ),
                ),
                (
                    "enable_dca",
                    models.BooleanField(
                        default=False,
                        help_text="Enable Dollar Cost Averaging (DCA) strategy - spreads buys over time",
                    ),
                ),
                (
                    "enable_grid",
                    models.BooleanField(
                        default=False,
                        help_text="Enable Grid Trading strategy - places multiple orders at different price levels",
                    ),
                ),
                (
                    "enable_twap",
                    models.BooleanField(
                        default=False,
                        help_text="Enable TWAP (Time-Weighted Average Price) strategy",
                    ),
                ),
                (
                    "enable_vwap",
                    models.BooleanField(
                        default=False,
                        help_text="Enable VWAP (Volume-Weighted Average Price) strategy",
                    ),
                ),
                (
                    "dca_num_intervals",
                    models.IntegerField(
                        default=5,
                        help_text="Number of DCA buy intervals (2-20)",
                        validators=[
                            django.core.validators.MinValueValidator(2),
                            django.core.validators.MaxValueValidator(20),
                        ],
                    ),
                ),
                (
                    "dca_interval_hours",
                    models.IntegerField(
                        default=2,
                        help_text="Hours between each DCA buy (1-168 hours = 1 week max)",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(168),
                        ],
                    ),
                ),
                (
                    "grid_num_levels",
                    models.IntegerField(
                        default=7,
                        help_text="Number of grid price levels (3-20)",
                        validators=[
                            django.core.validators.MinValueValidator(3),
                            django.core.validators.MaxValueValidator(20),
                        ],
                    ),
                ),
                (
                    "grid_profit_target_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("2.0"),
                        help_text="Target profit per grid level in percent (0.1-10.0%)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("10.0")),
                        ],
                    ),
                ),
                (
                    "trading_mode",
                    models.CharField(
                        choices=[
                            ("CONSERVATIVE", "Conservative"),
                            ("MODERATE", "Moderate"),
                            ("AGGRESSIVE", "Aggressive"),
                            ("CUSTOM", "Custom"),
                        ],
                        default="MODERATE",
                        help_text="Trading mode",
                        max_length=20,
                    ),
                ),
                (
                    "intel_level",
                    models.IntegerField(
                        default=5,
                        help_text="Intelligence level (1-10) controlling bot decision-making behavior",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(10),
                        ],
                    ),
                ),
                (
                    "use_fast_lane",
                    models.BooleanField(
                        default=True, help_text="Enable Fast Lane trading"
                    ),
                ),
                (
                    "use_smart_lane",
                    models.BooleanField(
                        default=False, help_text="Enable Smart Lane trading"
                    ),
                ),
                (
                    "fast_lane_threshold_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("100"),
                        help_text="Max trade size for Fast Lane",
                        max_digits=10,
                    ),
                ),
                (
                    "max_position_size_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("5.0"),
                        help_text="Max position size as % of portfolio",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "max_trade_size_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1000.00"),
                        help_text="Maximum trade size in USD (absolute limit)",
                        max_digits=12,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("10")),
                            django.core.validators.MaxValueValidator(Decimal("100000")),
                        ],
                    ),
                ),
                (
                    "stop_loss_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("5.0"),
                        help_text="Default stop loss percentage",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("50")),
                        ],
                    ),
                ),
                (
                    "take_profit_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10.0"),
                        help_text="Default take profit percentage",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("1000")),
                        ],
                    ),
                ),
                (
                    "max_hold_hours",
                    models.IntegerField(
                        default=72,
                        help_text="Maximum hours to hold a position before auto-close (1-720 hours)",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(720),
                        ],
                    ),
                ),
                (
                    "max_daily_trades",
                    models.IntegerField(
                        default=20,
                        help_text="Maximum trades per day",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(1000),
                        ],
                    ),
                ),
                (
                    "max_concurrent_positions",
                    models.IntegerField(
                        default=5,
                        help_text="Maximum concurrent open positions",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "min_liquidity_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10000"),
                        help_text="Minimum liquidity required",
                        max_digits=15,
                    ),
                ),
                (
                    "max_slippage_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1.0"),
                        help_text="Maximum allowed slippage",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01")),
                            django.core.validators.MaxValueValidator(Decimal("10")),
                        ],
                    ),
                ),
                (
                    "confidence_threshold",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("60"),
                        help_text="Minimum confidence for trades",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "allowed_tokens",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of allowed token addresses",
                    ),
                ),
                (
                    "blocked_tokens",
                    models.JSONField(
                        blank=True,
                        default=list,
                        help_text="List of blocked token addresses",
                    ),
                ),
                (
                    "custom_parameters",
                    models.JSONField(
                        blank=True, default=dict, help_text="Custom strategy parameters"
                    ),
                ),
                (
                    "autopilot_enabled",
                    models.BooleanField(
                        default=False,
                        help_text="Enable Auto Pilot for intelligent parameter adaptation",
                    ),
                ),
                (
                    "autopilot_started_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="When Auto Pilot was first activated",
                        null=True,
                    ),
                ),
                (
                    "autopilot_adjustments_count",
                    models.IntegerField(
                        default=0,
                        help_text="Total number of adjustments made by Auto Pilot",
                    ),
                ),
                (
                    "autopilot_last_adjustment",
                    models.DateTimeField(
                        blank=True,
                        help_text="Timestamp of most recent Auto Pilot adjustment",
                        null=True,
                    ),
                ),
                (
                    "min_position_size_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1.0"),
                        help_text="Minimum position size Auto Pilot can set",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("25")),
                        ],
                    ),
                ),
                (
                    "max_position_size_percent_limit",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("20.0"),
                        help_text="Maximum position size Auto Pilot can set",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1")),
                            django.core.validators.MaxValueValidator(Decimal("50")),
                        ],
                    ),
                ),
                (
                    "min_confidence_threshold",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("40.0"),
                        help_text="Minimum confidence threshold Auto Pilot can set",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("10")),
                            django.core.validators.MaxValueValidator(Decimal("95")),
                        ],
                    ),
                ),
                (
                    "max_confidence_threshold_limit",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("95.0"),
                        help_text="Maximum confidence threshold Auto Pilot can set",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("50")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "learning_rate",
                    models.DecimalField(
                        decimal_places=4,
                        default=Decimal("0.1000"),
                        help_text="Learning rate for parameter adjustments (0.0001 - 1.0)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.0001")),
                            django.core.validators.MaxValueValidator(Decimal("1.0")),
                        ],
                    ),
                ),
                (
                    "adaptation_aggressiveness",
                    models.CharField(
                        choices=[
                            ("CONSERVATIVE", "Conservative - Small adjustments"),
                            ("MODERATE", "Moderate - Balanced learning"),
                            ("AGGRESSIVE", "Aggressive - Fast adaptation"),
                        ],
                        default="MODERATE",
                        help_text="How aggressively Auto Pilot adapts parameters",
                        max_length=20,
                    ),
                ),
                (
                    "performance_window_trades",
                    models.IntegerField(
                        default=20,
                        help_text="Number of recent trades to consider for performance analysis",
                        validators=[
                            django.core.validators.MinValueValidator(5),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "adjustment_cooldown_minutes",
                    models.IntegerField(
                        default=30,
                        help_text="Minimum minutes between Auto Pilot adjustments",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(1440),
                        ],
                    ),
                ),
                (
                    "max_daily_adjustments",
                    models.IntegerField(
                        default=10,
                        help_text="Maximum parameter adjustments per day",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(100),
                        ],
                    ),
                ),
                (
                    "auto_disable_after_failures",
                    models.IntegerField(
                        default=5,
                        help_text="Disable Auto Pilot after N consecutive bad adjustments",
                        validators=[
                            django.core.validators.MinValueValidator(1),
                            django.core.validators.MaxValueValidator(20),
                        ],
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Configuration creation timestamp"
                    ),
                ),
                (
                    "updated_at",
                    models.DateTimeField(
                        auto_now=True, help_text="Last update timestamp"
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Associated trading account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="strategy_configs",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Strategy Configuration",
                "verbose_name_plural": "Strategy Configurations",
                "db_table": "paper_strategy_configs",
                "ordering": ["-updated_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperPosition",
            fields=[
                (
                    "position_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique position identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "token_address",
                    models.CharField(help_text="Token contract address", max_length=42),
                ),
                (
                    "token_symbol",
                    models.CharField(help_text="Token symbol", max_length=20),
                ),
                (
                    "token_name",
                    models.CharField(
                        blank=True, help_text="Token name", max_length=100
                    ),
                ),
                (
                    "quantity",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Amount held in wei",
                        max_digits=36,
                    ),
                ),
                (
                    "average_entry_price_usd",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Average entry price in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "total_invested_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Total amount invested",
                        max_digits=20,
                    ),
                ),
                (
                    "current_price_usd",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Current market price",
                        max_digits=20,
                    ),
                ),
                (
                    "current_value_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Current position value",
                        max_digits=20,
                    ),
                ),
                (
                    "unrealized_pnl_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Unrealized profit/loss",
                        max_digits=20,
                    ),
                ),
                (
                    "realized_pnl_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Realized profit/loss after closing",
                        max_digits=20,
                    ),
                ),
                (
                    "is_open",
                    models.BooleanField(
                        default=True, help_text="Whether position is still open"
                    ),
                ),
                (
                    "opened_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Position open timestamp"
                    ),
                ),
                (
                    "closed_at",
                    models.DateTimeField(
                        blank=True, help_text="Position close timestamp", null=True
                    ),
                ),
                (
                    "last_updated",
                    models.DateTimeField(
                        auto_now=True, help_text="Last update timestamp"
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Associated account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="positions",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Position",
                "verbose_name_plural": "Paper Positions",
                "db_table": "paper_positions",
                "ordering": ["-opened_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperOrder",
            fields=[
                (
                    "order_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique order identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "order_type",
                    models.CharField(
                        choices=[
                            ("LIMIT_BUY", "Limit Buy"),
                            ("LIMIT_SELL", "Limit Sell"),
                            ("STOP_LIMIT_BUY", "Stop-Limit Buy"),
                            ("STOP_LIMIT_SELL", "Stop-Limit Sell"),
                            ("TRAILING_STOP", "Trailing Stop"),
                        ],
                        help_text="Type of order",
                        max_length=20,
                    ),
                ),
                (
                    "token_address",
                    models.CharField(help_text="Token contract address", max_length=42),
                ),
                (
                    "token_symbol",
                    models.CharField(
                        help_text="Token symbol (e.g., AAVE, LINK)", max_length=20
                    ),
                ),
                (
                    "token_name",
                    models.CharField(
                        blank=True, help_text="Token full name", max_length=100
                    ),
                ),
                (
                    "amount_usd",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Order size in USD",
                        max_digits=20,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1.00"))
                        ],
                    ),
                ),
                (
                    "amount_token",
                    models.DecimalField(
                        blank=True,
                        decimal_places=18,
                        help_text="Order size in tokens (calculated from amount_usd)",
                        max_digits=36,
                        null=True,
                    ),
                ),
                (
                    "trigger_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Trigger price for limit orders and stop-limit orders",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1E-8"))
                        ],
                    ),
                ),
                (
                    "limit_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Limit price for stop-limit orders (execution price)",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1E-8"))
                        ],
                    ),
                ),
                (
                    "stop_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Stop price for stop-limit orders (same as trigger_price)",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1E-8"))
                        ],
                    ),
                ),
                (
                    "trail_percent",
                    models.DecimalField(
                        blank=True,
                        decimal_places=2,
                        help_text="Trailing stop percentage (e.g., 5.0 = 5% trail)",
                        max_digits=5,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.1")),
                            django.core.validators.MaxValueValidator(Decimal("50.0")),
                        ],
                    ),
                ),
                (
                    "trail_amount",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Trailing stop fixed amount (alternative to trail_percent)",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0.01"))
                        ],
                    ),
                ),
                (
                    "highest_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Highest price seen (for trailing stops)",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1E-8"))
                        ],
                    ),
                ),
                (
                    "current_stop_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Current trailing stop price (updated as price rises)",
                        max_digits=20,
                        null=True,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("1E-8"))
                        ],
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending"),
                            ("TRIGGERED", "Triggered"),
                            ("PARTIALLY_FILLED", "Partially Filled"),
                            ("FILLED", "Filled"),
                            ("CANCELLED", "Cancelled"),
                            ("EXPIRED", "Expired"),
                            ("FAILED", "Failed"),
                        ],
                        default="PENDING",
                        help_text="Current order status",
                        max_length=20,
                    ),
                ),
                (
                    "filled_amount_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Amount filled in USD (for partial fills)",
                        max_digits=20,
                    ),
                ),
                (
                    "filled_amount_token",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0"),
                        help_text="Amount filled in tokens (for partial fills)",
                        max_digits=36,
                    ),
                ),
                (
                    "average_fill_price",
                    models.DecimalField(
                        blank=True,
                        decimal_places=8,
                        help_text="Average execution price",
                        max_digits=20,
                        null=True,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Order placement timestamp"
                    ),
                ),
                (
                    "expires_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="Order expiration timestamp (optional)",
                        null=True,
                    ),
                ),
                (
                    "triggered_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="Timestamp when stop price was triggered",
                        null=True,
                    ),
                ),
                (
                    "filled_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="Timestamp when order was filled",
                        null=True,
                    ),
                ),
                (
                    "cancelled_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="Timestamp when order was cancelled",
                        null=True,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="User notes or order description"
                    ),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True, help_text="Error message if execution failed"
                    ),
                ),
                (
                    "related_trade",
                    models.ForeignKey(
                        blank=True,
                        help_text="Link to the trade that executed this order",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="originating_order",
                        to="paper_trading.papertrade",
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Paper trading account that placed this order",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="orders",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Order",
                "verbose_name_plural": "Paper Orders",
                "db_table": "paper_orders",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperAIThoughtLog",
            fields=[
                (
                    "thought_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique thought identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "decision_type",
                    models.CharField(
                        choices=[
                            ("BUY", "Buy"),
                            ("SELL", "Sell"),
                            ("HOLD", "Hold"),
                            ("SKIP", "Skip"),
                            ("STOP_LOSS", "Stop Loss"),
                            ("TAKE_PROFIT", "Take Profit"),
                        ],
                        help_text="Type of decision made",
                        max_length=20,
                    ),
                ),
                (
                    "token_address",
                    models.CharField(help_text="Token being analyzed", max_length=42),
                ),
                (
                    "token_symbol",
                    models.CharField(help_text="Token symbol", max_length=20),
                ),
                (
                    "confidence_level",
                    models.CharField(
                        choices=[
                            ("VERY_HIGH", "Very High (90-100%)"),
                            ("HIGH", "High (70-90%)"),
                            ("MEDIUM", "Medium (50-70%)"),
                            ("LOW", "Low (30-50%)"),
                            ("VERY_LOW", "Very Low (<30%)"),
                        ],
                        help_text="Confidence level category",
                        max_length=20,
                    ),
                ),
                (
                    "confidence_percent",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Exact confidence percentage (0-100)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "risk_score",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Risk assessment score (0-100, higher is riskier)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "opportunity_score",
                    models.DecimalField(
                        decimal_places=2,
                        help_text="Opportunity assessment score (0-100)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "primary_reasoning",
                    models.TextField(
                        help_text="Primary reasoning for the decision (1-3 sentences)"
                    ),
                ),
                (
                    "key_factors",
                    models.JSONField(
                        default=list,
                        help_text="Key factors that influenced the decision",
                    ),
                ),
                (
                    "positive_signals",
                    models.JSONField(
                        default=list, help_text="Positive signals identified"
                    ),
                ),
                (
                    "negative_signals",
                    models.JSONField(
                        default=list, help_text="Negative signals/risks identified"
                    ),
                ),
                (
                    "market_data",
                    models.JSONField(
                        default=dict, help_text="Market data snapshot at decision time"
                    ),
                ),
                (
                    "strategy_name",
                    models.CharField(
                        blank=True,
                        help_text="Strategy that generated this decision",
                        max_length=100,
                    ),
                ),
                (
                    "lane_used",
                    models.CharField(
                        choices=[("FAST", "Fast Lane"), ("SMART", "Smart Lane")],
                        default="FAST",
                        help_text="Which lane was used for analysis",
                        max_length=20,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When the thought was generated"
                    ),
                ),
                (
                    "analysis_time_ms",
                    models.IntegerField(
                        default=0, help_text="Time taken for analysis in milliseconds"
                    ),
                ),
                (
                    "paper_trade",
                    models.ForeignKey(
                        blank=True,
                        help_text="Associated paper trade (if executed)",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="thought_logs",
                        to="paper_trading.papertrade",
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Paper trading account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="thought_logs",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "AI Thought Log",
                "verbose_name_plural": "AI Thought Logs",
                "db_table": "paper_ai_thought_logs",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperTradingConfig",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        auto_created=True,
                        primary_key=True,
                        serialize=False,
                        verbose_name="ID",
                    ),
                ),
                (
                    "base_slippage_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.5"),
                        help_text="Base slippage percentage for all trades",
                        max_digits=5,
                    ),
                ),
                (
                    "gas_price_multiplier",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1.0"),
                        help_text="Multiplier for gas price simulation",
                        max_digits=5,
                    ),
                ),
                (
                    "execution_delay_ms",
                    models.IntegerField(
                        default=500,
                        help_text="Simulated execution delay in milliseconds",
                    ),
                ),
                (
                    "max_position_size_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("10.0"),
                        help_text="Max position size as % of portfolio",
                        max_digits=5,
                    ),
                ),
                (
                    "max_daily_trades",
                    models.IntegerField(default=50, help_text="Maximum trades per day"),
                ),
                (
                    "stop_loss_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("5.0"),
                        help_text="Default stop loss percentage",
                        max_digits=5,
                    ),
                ),
                (
                    "simulate_network_issues",
                    models.BooleanField(
                        default=True, help_text="Simulate occasional network failures"
                    ),
                ),
                (
                    "simulate_mev",
                    models.BooleanField(
                        default=True, help_text="Simulate MEV bot competition"
                    ),
                ),
                (
                    "failure_rate_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("2.0"),
                        help_text="Percentage of trades that should randomly fail",
                        max_digits=5,
                    ),
                ),
                (
                    "account",
                    models.OneToOneField(
                        help_text="Associated account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="config",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Trading Config",
                "verbose_name_plural": "Paper Trading Configs",
                "db_table": "paper_trading_configs",
            },
        ),
        migrations.CreateModel(
            name="PaperTradingSession",
            fields=[
                (
                    "session_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique session identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("RUNNING", "Running"),
                            ("PAUSED", "Paused"),
                            ("STOPPED", "Stopped"),
                            ("COMPLETED", "Completed"),
                            ("ERROR", "Error"),
                        ],
                        default="RUNNING",
                        help_text="Current session status",
                        max_length=20,
                    ),
                ),
                (
                    "started_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="Session start timestamp"
                    ),
                ),
                (
                    "stopped_at",
                    models.DateTimeField(
                        blank=True, help_text="Session stop timestamp", null=True
                    ),
                ),
                (
                    "last_activity",
                    models.DateTimeField(
                        auto_now=True, help_text="Last activity timestamp"
                    ),
                ),
                (
                    "total_trades",
                    models.IntegerField(
                        default=0, help_text="Total trades in this session"
                    ),
                ),
                (
                    "successful_trades",
                    models.IntegerField(
                        default=0, help_text="Number of successful trades"
                    ),
                ),
                (
                    "failed_trades",
                    models.IntegerField(default=0, help_text="Number of failed trades"),
                ),
                (
                    "metadata",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Additional session metadata",
                    ),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True, help_text="Error message if status is ERROR"
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Associated trading account",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="sessions",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
                (
                    "strategy_config",
                    models.ForeignKey(
                        help_text="Strategy configuration used",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="sessions",
                        to="paper_trading.paperstrategyconfiguration",
                    ),
                ),
            ],
            options={
                "verbose_name": "Paper Trading Session",
                "verbose_name_plural": "Paper Trading Sessions",
                "db_table": "paper_trading_sessions",
                "ordering": ["-started_at"],
            },
        ),
        migrations.CreateModel(
            name="PaperPerformanceMetrics",
            fields=[
                (
                    "metric_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique metric identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "period_start",
                    models.DateTimeField(help_text="Period start timestamp"),
                ),
                ("period_end", models.DateTimeField(help_text="Period end timestamp")),
                (
                    "total_trades",
                    models.IntegerField(default=0, help_text="Total trades in period"),
                ),
                (
                    "winning_trades",
                    models.IntegerField(
                        default=0, help_text="Number of winning trades"
                    ),
                ),
                (
                    "losing_trades",
                    models.IntegerField(default=0, help_text="Number of losing trades"),
                ),
                (
                    "win_rate",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Win rate percentage (0-100)",
                        max_digits=5,
                    ),
                ),
                (
                    "total_pnl_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Total profit/loss in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "total_pnl_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Total P&L as percentage",
                        max_digits=7,
                    ),
                ),
                (
                    "average_win_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average winning trade amount",
                        max_digits=20,
                    ),
                ),
                (
                    "average_loss_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average losing trade amount",
                        max_digits=20,
                    ),
                ),
                (
                    "largest_win_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Largest winning trade",
                        max_digits=20,
                    ),
                ),
                (
                    "largest_loss_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Largest losing trade",
                        max_digits=20,
                    ),
                ),
                (
                    "max_drawdown_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Maximum drawdown percentage",
                        max_digits=5,
                    ),
                ),
                (
                    "sharpe_ratio",
                    models.DecimalField(
                        decimal_places=3,
                        default=Decimal("0"),
                        help_text="Risk-adjusted return metric (Sharpe Ratio)",
                        max_digits=6,
                    ),
                ),
                (
                    "profit_factor",
                    models.DecimalField(
                        decimal_places=3,
                        default=Decimal("0"),
                        help_text="Ratio of gross profit to gross loss",
                        max_digits=6,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When metrics were calculated"
                    ),
                ),
                (
                    "session",
                    models.ForeignKey(
                        help_text="Associated trading session",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="metrics",
                        to="paper_trading.papertradingsession",
                    ),
                ),
            ],
            options={
                "verbose_name": "Performance Metrics",
                "verbose_name_plural": "Performance Metrics",
                "db_table": "paper_performance_metrics",
                "ordering": ["-period_end"],
            },
        ),
        migrations.CreateModel(
            name="AutoPilotPerformanceSnapshot",
            fields=[
                (
                    "snapshot_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique snapshot identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "timestamp",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When snapshot was taken"
                    ),
                ),
                (
                    "current_parameters",
                    models.JSONField(
                        default=dict,
                        help_text="Current parameter configuration at snapshot time",
                    ),
                ),
                (
                    "win_rate",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Win rate percentage",
                        max_digits=5,
                    ),
                ),
                (
                    "total_trades",
                    models.IntegerField(default=0, help_text="Total trades executed"),
                ),
                (
                    "winning_trades",
                    models.IntegerField(
                        default=0, help_text="Number of winning trades"
                    ),
                ),
                (
                    "losing_trades",
                    models.IntegerField(default=0, help_text="Number of losing trades"),
                ),
                (
                    "total_pnl_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Total profit/loss in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "average_profit_per_trade",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average profit per trade",
                        max_digits=20,
                    ),
                ),
                (
                    "average_win_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average winning trade amount",
                        max_digits=20,
                    ),
                ),
                (
                    "average_loss_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average losing trade amount",
                        max_digits=20,
                    ),
                ),
                (
                    "largest_win_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Largest winning trade",
                        max_digits=20,
                    ),
                ),
                (
                    "largest_loss_usd",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Largest losing trade",
                        max_digits=20,
                    ),
                ),
                (
                    "max_drawdown_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Maximum drawdown percentage",
                        max_digits=5,
                    ),
                ),
                (
                    "sharpe_ratio",
                    models.DecimalField(
                        decimal_places=3,
                        default=Decimal("0"),
                        help_text="Risk-adjusted return metric (Sharpe Ratio)",
                        max_digits=6,
                    ),
                ),
                (
                    "profit_factor",
                    models.DecimalField(
                        decimal_places=3,
                        default=Decimal("0"),
                        help_text="Ratio of gross profit to gross loss",
                        max_digits=6,
                    ),
                ),
                (
                    "market_volatility",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Market volatility index at snapshot time (0-100)",
                        max_digits=5,
                    ),
                ),
                (
                    "avg_gas_price_gwei",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0"),
                        help_text="Average gas price in this period",
                        max_digits=10,
                    ),
                ),
                (
                    "market_trend",
                    models.CharField(
                        default="neutral",
                        help_text="Market trend (bullish/bearish/neutral)",
                        max_length=20,
                    ),
                ),
                (
                    "market_conditions_detail",
                    models.JSONField(
                        default=dict, help_text="Detailed market conditions"
                    ),
                ),
                (
                    "autopilot_active",
                    models.BooleanField(
                        default=False,
                        help_text="Whether Auto Pilot was active during this period",
                    ),
                ),
                (
                    "adjustments_made_count",
                    models.IntegerField(
                        default=0,
                        help_text="Number of Auto Pilot adjustments made before this snapshot",
                    ),
                ),
                (
                    "last_adjustment_type",
                    models.CharField(
                        blank=True,
                        help_text="Type of most recent adjustment",
                        max_length=50,
                    ),
                ),
                (
                    "snapshot_period_hours",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("1"),
                        help_text="Time period covered by this snapshot in hours",
                        max_digits=6,
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True, help_text="Optional notes or observations"
                    ),
                ),
                (
                    "strategy_config",
                    models.ForeignKey(
                        help_text="Associated strategy configuration",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="performance_snapshots",
                        to="paper_trading.paperstrategyconfiguration",
                    ),
                ),
                (
                    "session",
                    models.ForeignKey(
                        blank=True,
                        help_text="Associated trading session",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="performance_snapshots",
                        to="paper_trading.papertradingsession",
                    ),
                ),
            ],
            options={
                "verbose_name": "Auto Pilot Performance Snapshot",
                "verbose_name_plural": "Auto Pilot Performance Snapshots",
                "db_table": "autopilot_performance_snapshots",
                "ordering": ["-timestamp"],
            },
        ),
        migrations.CreateModel(
            name="AutoPilotLog",
            fields=[
                (
                    "log_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique log identifier",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "timestamp",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When adjustment was made"
                    ),
                ),
                (
                    "adjustment_type",
                    models.CharField(
                        choices=[
                            ("POSITION_SIZE_INCREASE", "Position Size Increase"),
                            ("POSITION_SIZE_DECREASE", "Position Size Decrease"),
                            ("CONFIDENCE_INCREASE", "Confidence Threshold Increase"),
                            ("CONFIDENCE_DECREASE", "Confidence Threshold Decrease"),
                            ("FREQUENCY_INCREASE", "Trading Frequency Increase"),
                            ("FREQUENCY_DECREASE", "Trading Frequency Decrease"),
                            ("STOP_LOSS_TIGHTEN", "Stop Loss Tightened"),
                            ("STOP_LOSS_LOOSEN", "Stop Loss Loosened"),
                            ("TAKE_PROFIT_INCREASE", "Take Profit Increased"),
                            ("TAKE_PROFIT_DECREASE", "Take Profit Decreased"),
                            ("PAUSE_TRADING", "Trading Paused"),
                            ("RESUME_TRADING", "Trading Resumed"),
                            ("GAS_STRATEGY_ADJUST", "Gas Strategy Adjusted"),
                            ("RISK_TOLERANCE_ADJUST", "Risk Tolerance Adjusted"),
                        ],
                        help_text="Type of adjustment made",
                        max_length=50,
                    ),
                ),
                (
                    "parameter_name",
                    models.CharField(
                        help_text="Name of the parameter adjusted", max_length=50
                    ),
                ),
                (
                    "old_value",
                    models.DecimalField(
                        decimal_places=4,
                        help_text="Previous parameter value",
                        max_digits=10,
                    ),
                ),
                (
                    "new_value",
                    models.DecimalField(
                        decimal_places=4, help_text="New parameter value", max_digits=10
                    ),
                ),
                (
                    "change_percent",
                    models.DecimalField(
                        decimal_places=2, help_text="Percentage change", max_digits=7
                    ),
                ),
                (
                    "reason",
                    models.TextField(
                        help_text="Detailed explanation of why this adjustment was made"
                    ),
                ),
                (
                    "trigger_metric",
                    models.CharField(
                        help_text="Metric that triggered adjustment (e.g., 'win_rate', 'drawdown')",
                        max_length=50,
                    ),
                ),
                (
                    "trigger_value",
                    models.DecimalField(
                        decimal_places=4,
                        help_text="Value of the trigger metric",
                        max_digits=10,
                    ),
                ),
                (
                    "trigger_threshold",
                    models.DecimalField(
                        decimal_places=4,
                        default=Decimal("0"),
                        help_text="Threshold value that was crossed",
                        max_digits=10,
                    ),
                ),
                (
                    "performance_before",
                    models.JSONField(
                        default=dict, help_text="Performance metrics before adjustment"
                    ),
                ),
                (
                    "performance_after",
                    models.JSONField(
                        blank=True,
                        default=dict,
                        help_text="Performance metrics after adjustment (filled later)",
                        null=True,
                    ),
                ),
                (
                    "outcome",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending - Too early to tell"),
                            ("POSITIVE", "Positive - Improved performance"),
                            ("NEUTRAL", "Neutral - No significant change"),
                            ("NEGATIVE", "Negative - Worsened performance"),
                            ("UNKNOWN", "Unknown - Insufficient data"),
                        ],
                        default="PENDING",
                        help_text="Evaluation of adjustment outcome",
                        max_length=20,
                    ),
                ),
                (
                    "outcome_evaluated_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="When the outcome was evaluated",
                        null=True,
                    ),
                ),
                (
                    "outcome_notes",
                    models.TextField(
                        blank=True, help_text="Additional notes on the outcome"
                    ),
                ),
                (
                    "trades_since_adjustment",
                    models.IntegerField(
                        default=0,
                        help_text="Number of trades executed since this adjustment",
                    ),
                ),
                (
                    "market_conditions",
                    models.JSONField(
                        default=dict,
                        help_text="Market conditions at time of adjustment",
                    ),
                ),
                (
                    "confidence_in_adjustment",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("50"),
                        help_text="Auto Pilot's confidence in this adjustment (0-100)",
                        max_digits=5,
                    ),
                ),
                (
                    "is_reversal",
                    models.BooleanField(
                        default=False,
                        help_text="Whether this reverses a previous adjustment",
                    ),
                ),
                (
                    "reverses_log",
                    models.ForeignKey(
                        blank=True,
                        help_text="Previous adjustment this reverses",
                        null=True,
                        on_delete=django.db.models.deletion.SET_NULL,
                        related_name="reversed_by",
                        to="paper_trading.autopilotlog",
                    ),
                ),
                (
                    "strategy_config",
                    models.ForeignKey(
                        help_text="Associated strategy configuration",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="autopilot_logs",
                        to="paper_trading.paperstrategyconfiguration",
                    ),
                ),
                (
                    "session",
                    models.ForeignKey(
                        blank=True,
                        help_text="Associated trading session",
                        null=True,
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="autopilot_logs",
                        to="paper_trading.papertradingsession",
                    ),
                ),
            ],
            options={
                "verbose_name": "Auto Pilot Log",
                "verbose_name_plural": "Auto Pilot Logs",
                "db_table": "autopilot_logs",
                "ordering": ["-timestamp"],
            },
        ),
        migrations.CreateModel(
            name="StrategyRun",
            fields=[
                (
                    "strategy_id",
                    models.UUIDField(
                        default=uuid.uuid4,
                        editable=False,
                        help_text="Unique identifier for this strategy run",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "strategy_type",
                    models.CharField(
                        choices=[
                            ("DCA", "Dollar Cost Averaging"),
                            ("GRID", "Grid Trading"),
                            ("TWAP", "Time-Weighted Average Price"),
                            ("VWAP", "Volume-Weighted Average Price"),
                            ("CUSTOM", "Custom Strategy"),
                        ],
                        help_text="Type of trading strategy",
                        max_length=20,
                    ),
                ),
                (
                    "config",
                    models.JSONField(
                        default=dict,
                        help_text="Strategy-specific configuration parameters",
                    ),
                ),
                (
                    "status",
                    models.CharField(
                        choices=[
                            ("PENDING", "Pending"),
                            ("RUNNING", "Running"),
                            ("PAUSED", "Paused"),
                            ("COMPLETED", "Completed"),
                            ("CANCELLED", "Cancelled"),
                            ("FAILED", "Failed"),
                        ],
                        default="PENDING",
                        help_text="Current execution status",
                        max_length=20,
                    ),
                ),
                (
                    "progress_percent",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Completion percentage (0-100)",
                        max_digits=5,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0")),
                            django.core.validators.MaxValueValidator(Decimal("100")),
                        ],
                    ),
                ),
                (
                    "current_step",
                    models.CharField(
                        blank=True,
                        default="",
                        help_text="Current execution step description",
                        max_length=200,
                    ),
                ),
                (
                    "total_orders",
                    models.IntegerField(
                        default=0,
                        help_text="Total number of orders planned",
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "completed_orders",
                    models.IntegerField(
                        default=0,
                        help_text="Number of successfully completed orders",
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "failed_orders",
                    models.IntegerField(
                        default=0,
                        help_text="Number of failed orders",
                        validators=[django.core.validators.MinValueValidator(0)],
                    ),
                ),
                (
                    "total_invested",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Total USD amount invested so far",
                        max_digits=20,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                (
                    "average_entry",
                    models.DecimalField(
                        decimal_places=18,
                        default=Decimal("0.00"),
                        help_text="Average entry price across all orders",
                        max_digits=30,
                        validators=[
                            django.core.validators.MinValueValidator(Decimal("0"))
                        ],
                    ),
                ),
                (
                    "current_pnl",
                    models.DecimalField(
                        decimal_places=2,
                        default=Decimal("0.00"),
                        help_text="Current profit/loss in USD",
                        max_digits=20,
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When strategy was created"
                    ),
                ),
                (
                    "started_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="When strategy execution started",
                        null=True,
                    ),
                ),
                (
                    "paused_at",
                    models.DateTimeField(
                        blank=True, help_text="When strategy was paused", null=True
                    ),
                ),
                (
                    "completed_at",
                    models.DateTimeField(
                        blank=True,
                        help_text="When strategy completed successfully",
                        null=True,
                    ),
                ),
                (
                    "cancelled_at",
                    models.DateTimeField(
                        blank=True, help_text="When strategy was cancelled", null=True
                    ),
                ),
                (
                    "notes",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="User notes about this strategy",
                    ),
                ),
                (
                    "error_message",
                    models.TextField(
                        blank=True,
                        default="",
                        help_text="Error message if strategy failed",
                    ),
                ),
                (
                    "account",
                    models.ForeignKey(
                        help_text="Account executing this strategy",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="strategy_runs",
                        to="paper_trading.papertradingaccount",
                    ),
                ),
            ],
            options={
                "verbose_name": "Strategy Run",
                "verbose_name_plural": "Strategy Runs",
                "db_table": "paper_strategy_runs",
                "ordering": ["-created_at"],
            },
        ),
        migrations.CreateModel(
            name="StrategyOrder",
            fields=[
                (
                    "id",
                    models.BigAutoField(
                        help_text="Auto-incrementing ID",
                        primary_key=True,
                        serialize=False,
                    ),
                ),
                (
                    "order_sequence",
                    models.IntegerField(
                        help_text="Order sequence number within strategy (1, 2, 3...)",
                        validators=[django.core.validators.MinValueValidator(1)],
                    ),
                ),
                (
                    "created_at",
                    models.DateTimeField(
                        auto_now_add=True, help_text="When this link was created"
                    ),
                ),
                (
                    "order",
                    models.ForeignKey(
                        help_text="The actual order",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="strategy_links",
                        to="paper_trading.paperorder",
                    ),
                ),
                (
                    "strategy_run",
                    models.ForeignKey(
                        help_text="Strategy this order belongs to",
                        on_delete=django.db.models.deletion.CASCADE,
                        related_name="strategy_orders",
                        to="paper_trading.strategyrun",
                    ),
                ),
            ],
            options={
                "verbose_name": "Strategy Order",
                "verbose_name_plural": "Strategy Orders",
                "db_table": "paper_strategy_orders",
                "ordering": ["order_sequence"],
            },
        ),
        migrations.AddIndex(
            model_name="papertradingaccount",
            index=models.Index(
                fields=["user", "is_active"], name="paper_tradi_user_id_4c4334_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertradingaccount",
            index=models.Index(
                fields=["created_at"], name="paper_tradi_created_86fbd6_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertrade",
            index=models.Index(
                fields=["account", "status"], name="paper_trade_account_22eae7_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertrade",
            index=models.Index(
                fields=["created_at"], name="paper_trade_created_bbc42f_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertrade",
            index=models.Index(
                fields=["trade_type"], name="paper_trade_trade_t_17c239_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperstrategyconfiguration",
            index=models.Index(
                fields=["account", "is_active"], name="paper_strat_account_a2c8e3_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperstrategyconfiguration",
            index=models.Index(
                fields=["autopilot_enabled"], name="paper_strat_autopil_e13393_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperstrategyconfiguration",
            index=models.Index(
                fields=["created_at"], name="paper_strat_created_315c42_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="paperstrategyconfiguration",
            unique_together={("account", "name")},
        ),
        migrations.AddIndex(
            model_name="paperposition",
            index=models.Index(
                fields=["account", "is_open"], name="paper_posit_account_ccd9b9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperposition",
            index=models.Index(
                fields=["token_address"], name="paper_posit_token_a_b4c146_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="paperposition",
            unique_together={("account", "token_address", "is_open")},
        ),
        migrations.AddIndex(
            model_name="paperorder",
            index=models.Index(
                fields=["account", "status"], name="paper_order_account_5efd27_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperorder",
            index=models.Index(
                fields=["order_type", "status"], name="paper_order_order_t_cd3bd8_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperorder",
            index=models.Index(
                fields=["token_address", "status"],
                name="paper_order_token_a_f3da6d_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="paperorder",
            index=models.Index(
                fields=["status", "created_at"], name="paper_order_status_9c8ca5_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperorder",
            index=models.Index(
                fields=["expires_at"], name="paper_order_expires_511136_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperaithoughtlog",
            index=models.Index(
                fields=["account", "created_at"], name="paper_ai_th_account_6c5652_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperaithoughtlog",
            index=models.Index(
                fields=["decision_type"], name="paper_ai_th_decisio_eeb7fd_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperaithoughtlog",
            index=models.Index(
                fields=["confidence_level"], name="paper_ai_th_confide_c47c8d_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperaithoughtlog",
            index=models.Index(
                fields=["token_address"], name="paper_ai_th_token_a_7752b9_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertradingsession",
            index=models.Index(
                fields=["account", "status"], name="paper_tradi_account_fa44dc_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertradingsession",
            index=models.Index(
                fields=["started_at"], name="paper_tradi_started_e880fd_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="papertradingsession",
            index=models.Index(fields=["status"], name="paper_tradi_status_3be48d_idx"),
        ),
        migrations.AddIndex(
            model_name="paperperformancemetrics",
            index=models.Index(
                fields=["session", "period_end"], name="paper_perfo_session_816fb6_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperperformancemetrics",
            index=models.Index(
                fields=["win_rate"], name="paper_perfo_win_rat_3d493e_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="paperperformancemetrics",
            index=models.Index(
                fields=["total_pnl_percent"], name="paper_perfo_total_p_04bcc6_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotperformancesnapshot",
            index=models.Index(
                fields=["strategy_config", "timestamp"],
                name="autopilot_p_strateg_106e87_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotperformancesnapshot",
            index=models.Index(
                fields=["autopilot_active"], name="autopilot_p_autopil_3925bf_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotperformancesnapshot",
            index=models.Index(
                fields=["win_rate"], name="autopilot_p_win_rat_bf7ae8_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotperformancesnapshot",
            index=models.Index(
                fields=["timestamp"], name="autopilot_p_timesta_42f4c1_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotperformancesnapshot",
            index=models.Index(
                fields=["session", "timestamp"], name="autopilot_p_session_f9d155_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotlog",
            index=models.Index(
                fields=["strategy_config", "timestamp"],
                name="autopilot_l_strateg_94b5cd_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotlog",
            index=models.Index(
                fields=["adjustment_type"], name="autopilot_l_adjustm_fc618d_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotlog",
            index=models.Index(
                fields=["outcome"], name="autopilot_l_outcome_b7c9c0_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotlog",
            index=models.Index(
                fields=["timestamp"], name="autopilot_l_timesta_5a2538_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="autopilotlog",
            index=models.Index(
                fields=["session", "timestamp"], name="autopilot_l_session_e80358_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="strategyrun",
            index=models.Index(
                fields=["account", "status"], name="paper_strat_account_48dc55_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="strategyrun",
            index=models.Index(
                fields=["strategy_type", "status"],
                name="paper_strat_strateg_44d5a6_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="strategyrun",
            index=models.Index(
                fields=["status", "created_at"], name="paper_strat_status_5e3ff5_idx"
            ),
        ),
        migrations.AddIndex(
            model_name="strategyrun",
            index=models.Index(
                fields=["account", "strategy_type"],
                name="paper_strat_account_1321ba_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="strategyorder",
            index=models.Index(
                fields=["strategy_run", "order_sequence"],
                name="paper_strat_strateg_79d5b6_idx",
            ),
        ),
        migrations.AddIndex(
            model_name="strategyorder",
            index=models.Index(
                fields=["order", "created_at"], name="paper_strat_order_i_f0a3ae_idx"
            ),
        ),
        migrations.AlterUniqueTogether(
            name="strategyorder",
            unique_together={
                ("strategy_run", "order"),
                ("strategy_run", "order_sequence"),
            },
        ),
    ]
